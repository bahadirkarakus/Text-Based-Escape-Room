using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;

namespace ConsoleApp1
{
    public static class LevelData
    {
        // Levels are loaded from external text files if available,
        // otherwise built-in char[,] maps are used as a fallback.
        public static List<char[,]> Levels { get; } = LoadLevels();

        private static List<char[,]> LoadLevels()
        {
            var levels = new List<char[,]>();

            try
            {
                // Look for text files in the "Levels" folder next to the executable.
                string baseDir = AppContext.BaseDirectory;
                string levelsDir = Path.Combine(baseDir, "Levels");

                if (Directory.Exists(levelsDir))
                {
                    var files = Directory.GetFiles(levelsDir, "level*.txt");
                    Array.Sort(files, StringComparer.OrdinalIgnoreCase);

                    foreach (var file in files)
                    {
                        var allLines = File.ReadAllLines(file)
                            .Where(l => !string.IsNullOrWhiteSpace(l))
                            .ToArray();

                        if (allLines.Length == 0)
                            continue;

                        int rows = allLines.Length;
                        int cols = allLines.Max(l => l.Length);
                        var map = new char[rows, cols];

                        for (int r = 0; r < rows; r++)
                        {
                            var line = allLines[r];
                            for (int c = 0; c < cols; c++)
                            {
                                map[r, c] = c < line.Length ? line[c] : ' ';
                            }
                        }

                        levels.Add(map);
                    }
                }
            }
            catch
            {
                // If anything goes wrong with file loading, fall back to built-in maps.
            }

            if (levels.Count == 0)
            {
                levels = LoadBuiltInLevels();
            }

            return levels;
        }

        private static List<char[,]> LoadBuiltInLevels()
        {
            return new List<char[,]>
            {
                // LEVEL 1
                new char[,] {
                    { '#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#' },
                    { '#','@',' ',' ',' ',' ',' ',' ','P',' ',' ',' ',' ',' ',' ',' ',' ','K',' ','#' },
                    { '#',' ','#','#','#',' ','#','#','#','#','#',' ','#','#','#',' ','#',' ',' ','#' },
                    { '#',' ',' ',' ',' ',' ','H',' ',' ',' ',' ',' ',' ',' ','S',' ',' ',' ',' ','#' },
                    { '#',' ','#','#','#',' ','#','#','#',' ','#','#','#',' ','#','#','#','F',' ','#' },
                    { '#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#' },
                    { '#',' ','#',' ','#','#','#',' ','#','#','#',' ','#','#','#','#','#','L','#','#' },
                    { '#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','D','E','#' },
                    { '#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#' }
                },
                // LEVEL 2
                new char[,] {
                    { '#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#' },
                    { '#','@',' ',' ','#',' ',' ','M',' ','#','P',' ',' ','#',' ',' ','K',' ',' ','#' },
                    { '#',' ','#',' ','#',' ','#','#',' ','#','#',' ','#','#',' ','#','#','#',' ','#' },
                    { '#',' ','#',' ',' ',' ',' ','S',' ',' ',' ',' ',' ',' ',' ',' ',' ','O',' ','#' },
                    { '#',' ','#','#','#','#','#',' ','#','#','#','#','#',' ','#','#','#','#',' ','#' },
                    { '#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','H',' ','#' },
                    { '#',' ','#',' ','#','#','#',' ','#','#','#','#','#',' ','#','#','#','D',' ','#' },
                    { '#',' ',' ',' ','L',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','E',' ','#' },
                    { '#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#' }
                },
                // LEVEL 3
                new char[,] {
                    { '#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#' },
                    { '#','@',' ','M',' ',' ','P',' ',' ','S',' ',' ','M',' ',' ','K',' ',' ',' ','#' },
                    { '#',' ','#','#','#','#','#','#','#',' ','#','#','#','#','#','#','#','#',' ','#' },
                    { '#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#' },
                    { '#',' ','#','H',' ','#','O',' ','#',' ','#',' ','#','H',' ','#','F',' ','#','#' },
                    { '#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','L',' ','#' },
                    { '#',' ','#','#','#','#','#','#','#',' ','#','#','#','#','#','#','#','D',' ','#' },
                    { '#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','E',' ','#' },
                    { '#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#' }
                },
                // LEVEL 4 - BOSS LEVEL
                new char[,] {
                    { '#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#' },
                    { '#','@',' ',' ','H',' ','W',' ',' ',' ','K',' ',' ',' ','W',' ','H',' ',' ','#' },
                    { '#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#' },
                    { '#',' ',' ',' ',' ',' ',' ','S',' ','B',' ','S',' ',' ',' ',' ',' ',' ',' ','#' },
                    { '#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#' },
                    { '#',' ',' ','O',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','O',' ',' ',' ','#' },
                    { '#',' ',' ',' ',' ',' ',' ',' ',' ','P',' ',' ',' ',' ','L',' ',' ','D',' ','#' },
                    { '#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','E',' ','#' },
                    { '#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#' }
                }
            };
        }
    }
}
